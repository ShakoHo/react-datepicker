!function(a,b){var c=a.createElement,d=b.Datepicker,e=function(a){a instanceof Date||(a=new Date);var b=this;b.init={},b.init.y=b.y=a.getFullYear(),b.init.m=b.m=a.getMonth()+1,b.init.d=b.d=a.getDate()},f=e.prototype;f.toDate=function(){var a=this,b=new Date;return b.setFullYear(a.y),b.setMonth(a.m-1),b.setDate(a.d),b},f.monthDays=[1,-2,1,0,1,0,1,1,0,1,0,1],f.nextMonth=function(){var a=this;return 12==a.m?(a.y+=1,a.m=1):a.m+=1,a.d=1,a},f.prevMonth=function(){var a=this;return 1==a.m?(a.y-=1,a.m=12):a.m-=1,a.d=1,a},f.getMonthDays=function(){var a=this,b=2==a.m&&(a.y%4==0&&a.y%100!=0||a.y%400==0)?1:0;return a.monthDays[a.m-1]+30+b},f.format=function(a){var b=this,c={"M+":b.m,"d+":b.d,"q+":Math.floor((b.m+2)/3)};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(b.y+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return a};var g=["一","二","三","四","五","六","日"],h=["一","二","三","四","五","六","七","八","九","十","十一","十二"].map(function(a){return a+"月"}),k=function(a,b){return a+" 年 "+b+" 月"},l="c",m="i",n="am-datepicker-",o={BASIC:n+"day",ACTIVE:n+"day am-active",DISABLED:n+"day am-disabled",CURRENT:n+"day am-current"},p=yearClassSet={BASIC:"",ACTIVE:"am-active",CURRENT:"am-current",DISABLED:"am-disabled"},q=function(a){var b,c=(a.from,a.to,a.current),d=0,f=0,g=0,h=0,i={},j=c.toDate(),k=new e(j).prevMonth().getMonthDays(),n=(new e(j).nextMonth().getMonthDays(),c.getMonthDays());j.setDate(1);for(var o=(j.getDay()+6)%7;o>d;d++,h++)i[l+h]=-1,i[m+h]=k-o+1+d;for(;n>f;f++,h++)i[l+h]=0,i[m+h]=f+1;for(;42-n-o>g;g++,h++)i[l+h]=-1,i[m+h]=g+1;return c.y==c.init.y&&c.m==c.init.m&&(i[l+(o+c.init.d-1)]=2),b=o+c.d-1,i[l+b]=1,{active:b,obj:i}},r=function(a){for(var b,c=(a.from,a.to,a.current),d=0,e={};12>d;d++)e[l+d]=0,e[m+d]=d+1;return c.y==c.init.y&&(e[l+(c.init.m-1)]=2),b=c.m-1,e[l+b]=1,{active:b,obj:e}},s=function(a){for(var b,c=(a.from,a.to,a.current),d=0,e={},f=c.y,g=f%12,h=f-g;12>d;d++)e[l+d]=0,e[m+d]=h+d;return c.init.y-c.init.y%12==h&&(e[l+c.init.y%12]=2),b=g,e[l+b]=1,{active:b,obj:e}},t=function(a,b,c){var d=null,e=c;switch(a){case-1:d=b.DISABLED,e=null;break;case 0:d=b.BASIC;break;case 1:d=b.ACTIVE;break;case 2:d=b.CURRENT}return[d,e]},u={active:null,getInitialState:function(){var a=this,b=a.caculate(a.props);return a.active=b.active,b.obj},componentWillReceiveProps:function(a){var b=this,c=b.caculate(a);b.active=c.active,b.setState(c.obj)},onClick:function(a,b){b.stopPropagation();var c=this,d=c.active,e={};null!==d&&d!==a&&1===c.state[l+d]&&(e[l+d]=0),d!==a&&(e[l+a]=2==c.state[l+a]?2:1,c.active=a),c.props.select(c.state[m+a])}},v=a.createClass({displayName:"DatepickerDayTbody",mixins:[u],caculate:q,render:function(){var a=this,b=[];for(i=0;i<6;i++){var d=[];for(j=0;j<7;j++){var e=7*i+j,f=t(a.state[l+e],o,a.onClick.bind(a,e)),g=f[0],h=f[1];d.push(c("td",{key:e,className:g,onClick:h},a.state[m+e]))}b.push(c("tr",{key:i},d))}return c("tbody",null,b)}}),w=a.createClass({displayName:"DatepickerMonthTbody",mixins:[u],caculate:r,render:function(){for(var a,b,d,e=this,f=[],g=0;12>g;g++)d=t(e.state[l+g],p,e.onClick.bind(e,g)),a=d[0],b=d[1],f.push(c("span",{key:"m-"+g,className:a,onClick:b},h[e.state[m+g]-1]));return c("tbody",null,c("tr",null,c("td",{colSpan:"7"},f)))}}),x=a.createClass({displayName:"DatepickerYearTbody",mixins:[u],caculate:s,render:function(){for(var a,b,d,e=this,f=[],g=0;12>g;g++)d=t(e.state[l+g],yearClassSet,e.onClick.bind(e,g)),a=d[0],b=d[1],f.push(c("span",{key:"y-"+g,className:a,onClick:b},e.state[m+g]));return c("tbody",null,c("tr",null,c("td",{colSpan:"7"},f)))}}),y=a.createClass({displayName:"DatepickerPanel",getDefaultProps:function(){return{from:null,to:null,current:new e,select:null}},getInitialState:function(){var a=this.props;return{panel:a.panel,current:a.current}},componentWillReceiveProps:function(a){this.setState({current:a.current})},changePanel:function(){var a=this;this.setState({panel:a.state.panel+1})},selectDay:function(a){var b=this,c=b.state.current;c.d=a,b.setState({current:c}),b.props.select(c)},selectPanel:function(a,b){var c=this,d=c.state.current;1==a?(d.m=b,b!=d.init.m&&(d.d=1)):(d.y=b,b!=d.init.y&&(d.d=1)),this.setState({current:d,panel:a})},onWheel:function(a){a.preventDefault(),this.goIcon(a.deltaY>0?1:-1)},goIcon:function(a,b){b&&b.stopPropagation();var c=this;stateArgs=c.state,propArgs=c.props,1==stateArgs.panel?a>0?stateArgs.current.nextMonth():stateArgs.current.prevMonth():2==stateArgs.panel?stateArgs.current.y+=a>0?1:-1:3==stateArgs.panel&&(stateArgs.current.y+=a>0?12:-12),c.setState({current:stateArgs.current})},render:function(){var a=this;if(stateArgs=a.state,propArgs=a.props,table=null,tableClass=n+"table",headClass=n+"header",switchClass=n+"switch",selectClass=n+"select",prevTh=c("th",{className:n+"prev"},c("i",{className:n+"prev-icon",onClick:a.goIcon.bind(a,1)})),nextTh=c("th",{className:n+"next"},c("i",{className:n+"next-icon",onClick:a.goIcon.bind(a,-1)})),1==stateArgs.panel)table=c("table",{className:tableClass},c("thead",null,c("tr",{className:headClass},prevTh,c("th",{colSpan:"5",className:switchClass},c("div",{className:selectClass,onClick:a.changePanel},k(stateArgs.current.y,stateArgs.current.m))),nextTh),c("tr",null,g.map(function(a,b){return c("th",{key:"th-"+b,className:n+"dow"},a)}))),c(v,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,select:a.selectDay}));else if(2==stateArgs.panel)table=c("table",{className:tableClass},c("thead",null,c("tr",{className:headClass},prevTh,c("th",{colSpan:"5",className:switchClass},c("div",{className:selectClass,onClick:a.changePanel},stateArgs.current.y)),nextTh)),c(w,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,select:a.selectPanel.bind(a,1)}));else if(3==stateArgs.panel){var b=stateArgs.current.y-stateArgs.current.y%10;table=c("table",{className:tableClass},c("thead",null,c("tr",{className:headClass},prevTh,c("th",{colSpan:"5",className:switchClass},c("div",{className:selectClass},b,"-",b+11)),nextTh)),c(x,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,select:a.selectPanel.bind(a,2)}))}return c("div",{className:"am-datepicker",style:{display:"block"},onWheel:a.onWheel},c("div",{className:n+"days",style:{display:"block"}},table))}}),z=a.createClass({displayName:"DatepickerInput",getDefaultProps:function(){return{from:null,to:null,current:new e,format:"yyyy-MM-dd",onSelect:null,panel:1}},getInitialState:function(){var a=this.props;return{visible:!1,current:new e(a.current)}},componentWillReceiveProps:function(a){this.setState({visible:!1,current:a.current})},onClick:function(a){a.stopPropagation();var b=this;this.setState({visible:!b.state.visible})},onSelect:function(a){var b=this,c=b.props.onSelect;"function"==typeof c&&c(a),b.setState({visible:!1,current:a})},render:function(){var a=this,b=a.state,d=a.props;return c("div",{className:"am-input-group"},c("input",{type:"text",className:"am-form-field",value:b.current.format(d.format),onClick:a.onClick}),c("div",{style:{display:b.visible?null:"none"}},c(y,{from:d.from,to:d.to,panel:d.panel,current:b.current,select:a.onSelect})))}});b.Datepicker=z,z.setTitle=function(a){a.weekDays&&(g=a.weekDays),a.yearMonths&&(h=a.yearMonths),a.dayTitle&&(k=a.dayTitle)},z.noConflict=function(){return b.Datepicker=d,z}}(React,window);